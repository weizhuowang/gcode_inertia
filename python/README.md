# G-Code Inertia Python Package (gcode-inertia-py)

Pure Python implementation of the G-code mass and inertia calculator. This is the Python version of the gcode_inertia project.

## Installation

```bash
# From the python directory
pip install -e .

# Or install from parent directory
pip install -e ./python
```

## Usage

### Command Line

```bash
# Basic usage
gcode-inertia-py -f part.gcode

# With custom filament properties
gcode-inertia-py -f part.gcode --diameter 1.75 --density 1.24

# Output URDF format
gcode-inertia-py -f part.gcode --output urdf
```

### Bambu Lab G-code Detection

The tool automatically detects if a G-code file was generated by Bambu Lab slicers (BambuStudio) and displays a colored notification:
- **Green checkmark (✓)**: Bambu Lab G-code detected - extra features are implemented
- **Red X (✗)**: Not Bambu Lab G-code

This detection helps identify files that may benefit from slicer-specific optimizations.

### Python API

```python
import numpy as np
from gcode_inertia import parse_segments

# Parse G-code
segments = parse_segments(gcode_string, filament_diameter=1.75, filament_density=1.24)

# Calculate properties
total_mass = sum(seg.mass() for seg in segments)

# Center of mass
weighted_com = sum(seg.center() * seg.mass() for seg in segments)
com = weighted_com / total_mass

# Inertia tensor
inertia = sum(seg.inertia() for seg in segments)
```

## Testing

```bash
# Run tests with pytest
pytest tests/
```

## Coordinate System

Same as the Rust version - all calculations are in the 3D printer's coordinate frame. See main README for details on coordinate transformations.

## Version History

### v0.3.0 (2025-08-03)
- **Bug Fixes**:
  - Fixed Z-axis center of mass calculation - now correctly positions mass at center of deposited layer (not nozzle position)
  - Added 2mm Y-axis offset correction for Bambu Lab slicer coordinate system
- **Improved Accuracy**:
  - Dynamic layer height detection from G-code for accurate Z calculations
  - Proper handling of material deposition physics

### v0.2.0
- **Bambu Lab G-code Support**: 
  - Automatic detection of Bambu Lab slicer generated files
  - Multi-object detection with error handling (only single objects supported)
  - Calibration line filtering - ignores purge/calibration material before first OBJECT_ID
- **Updated Default Density**: Changed from 1.25 to 1.24 g/cm³ (standard PLA density)
- **Improved CLI Output**: Color-coded status messages for better user feedback

### v0.1.0 (Initial Release)
- Basic G-code parsing for G0/G1/G2/G3 moves with extrusion
- Mass and inertia tensor calculations
- JSON and URDF output formats
- Support for absolute/relative positioning and extrusion modes